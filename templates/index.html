<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Milk Tracker</title>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #89f7fe, #66a6ff);
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 0;
    }

    h1 {
      font-size: 2.5em;
      margin-top: 30px;
    }

    .month-buttons {
      margin: 30px auto;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }

    button {
      background: white;
      color: #333;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }

    button:hover {
      background: #ffcf6f;
      color: #000;
      transform: scale(1.1);
    }

    .container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 30px;
      flex-wrap: wrap;
    }

    .data-card {
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid #fff;
      border-radius: 15px;
      padding: 20px;
      min-width: 280px;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
      transition: 0.3s;
    }

    .data-card:hover {
      transform: scale(1.05);
    }

    .calendar {
      background: rgba(255, 255, 255, 0.15);
      border: 2px solid #fff;
      border-radius: 15px;
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      min-width: 300px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    .calendar-day {
      padding: 10px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.3);
      cursor: pointer;
      transition: 0.3s;
    }

    .calendar-day:hover {
      background: rgba(255, 255, 255, 0.6);
    }

    footer {
      margin-top: 50px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.2);
      border-top: 1px solid #fff;
    }

    footer p {
      margin: 4px 0;
    }

    #note {
      border: 2px solid white;
      padding: 10px;
      width: fit-content;
      margin: 20px auto;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>Milk Tracker</h1>
  <div id="note">Click a month to see data and tracker</div>

  <div class="month-buttons">
    <button onclick="loadMonth('January')">January</button>
    <button onclick="loadMonth('February')">February</button>
    <button onclick="loadMonth('March')">March</button>
    <button onclick="loadMonth('April')">April</button>
    <button onclick="loadMonth('May')">May</button>
    <button onclick="loadMonth('June')">June</button>
    <button onclick="loadMonth('July')">July</button>
    <button onclick="loadMonth('August')">August</button>
    <button onclick="loadMonth('September')">September</button>
    <button onclick="loadMonth('October')">October</button>
    <button onclick="loadMonth('November')">November</button>
    <button onclick="loadMonth('December')">December</button>
  </div>

  <div class="container">
    <div id="data" class="data-card"></div>
    <div id="calendar" class="calendar"></div>
  </div>

  <footer>
    <p><b>Powered by Flask</b></p>
    <p style="font-size: 14px;">Made by Farhan ðŸ’»</p>
  </footer>

  <script>
    let milkData = JSON.parse(localStorage.getItem("milkData")) || {};

    function saveTracker(month, date, status) {
      if (!milkData[month]) milkData[month] = {};
      milkData[month][date] = status;
      localStorage.setItem("milkData", JSON.stringify(milkData));
    }

    function loadTracker(month) {
      const days = document.querySelectorAll(".calendar-day");
      days.forEach(day => {
        const date = day.dataset.date;
        if (milkData[month] && milkData[month][date]) {
          day.style.backgroundColor = milkData[month][date] === "green" ? "lightgreen" : "salmon";
        } else {
          day.style.backgroundColor = "";
        }
      });
    }

    function loadCalendar(month) {
      const calendar = document.getElementById("calendar");
      calendar.innerHTML = "";
      const today = new Date();
      const year = today.getFullYear();
      const monthIndex = new Date(`${month} 1, ${year}`).getMonth();
      const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();

      for (let i = 1; i <= daysInMonth; i++) {
        const div = document.createElement("div");
        div.classList.add("calendar-day");
        div.dataset.date = i;
        div.innerText = i;
        calendar.appendChild(div);
      }

      loadTracker(month);
    }

    function loadMonth(month) {
      fetch(`/month/${month}`)
        .then(res => res.json())
        .then(data => {
          if (data.error) {
            document.getElementById("data").innerHTML = `<h3>${data.error}</h3>`;
          } else {
            document.getElementById("data").innerHTML = `
              <h2>${data["MONTH"]}</h2>
              <p><b>Paid:</b> ${data["PAID"]}</p>
              <p><b>No. of Days in Month:</b> ${data["NO. OF DAYS IN MONTH"]}</p>
              <p><b>No. of Days Absent:</b> ${data["NO. OF DAYS ABSENT"]}</p>
              <p><b>No. of Days Coming:</b> ${data["NO. OF DAYS COMING"]}</p>
              <p><b>Amount:</b> ${data["AMOUNT"]}</p>
              <p><b>Payment Mode:</b> ${data["PAYMENT MODE"] || "N/A"}</p>
            `;
            loadCalendar(month);
          }
        })
        .catch(() => {
          document.getElementById("data").innerHTML = "<h3>Error loading data</h3>";
        });
    }

    document.addEventListener("click", function (e) {
      if (e.target.classList.contains("calendar-day")) {
        const day = e.target;
        const month = document.querySelector("#data h2")?.textContent?.trim();
        if (!month) return;

        if (day.style.backgroundColor === "lightgreen") {
          day.style.backgroundColor = "salmon";
          saveTracker(month, day.dataset.date, "red");
        } else if (day.style.backgroundColor === "salmon") {
          day.style.backgroundColor = "";
          saveTracker(month, day.dataset.date, "");
        } else {
          day.style.backgroundColor = "lightgreen";
          saveTracker(month, day.dataset.date, "green");
        }
      }
    });
  </script>
</body>
</html>



